Reproducible Reserach Assignment 1
========================================================

Loading Data into R, checking for column names, transfering date column to the POSIX format;


```r
setwd("~/Dropbox/mine/My_Coursera/Reproducible_Reserach_Assignment_1/RepData_PeerAssessment1/")
data <- read.csv("activity.csv")
names(data)
```

```
## [1] "steps"    "date"     "interval"
```


Part1: What is mean total number of steps taken per day?

In this step, first the data will be subset to small chunks per each day, then mean and median of each subset will be calculated. At the end, meanPerDay and medianPerDay variables show mean and median value for each day.


```r
days <- seq(from = as.Date("2012-10-01"), to = as.Date("2012-11-30"), by = "days")

stepsMean <- vector("numeric", length = length(days))
stepsMedian <- vector("numeric", length = length(days))
totalSteps <- vector("numeric", length = length(days))
for (i in seq_along(days)) {
    b <- subset(data, as.Date(data$date, format = "%Y-%m-%d") == days[i])
    stepsMean[i] <- mean(as.numeric(b$steps), na.rm = TRUE)
    stepsMedian[i] <- median(as.numeric(b$steps), na.rm = TRUE)
    totalSteps[i] <- sum(as.numeric(b$steps), na.rm = TRUE)
}

plot(days, totalSteps)
lines(days, totalSteps)
```

![plot of chunk mean_per_day](figure/mean_per_day.png) 

```r
meanPerDay <- cbind(as.character(days), as.character(stepsMean))
medianPerDay <- cbind(as.character(days), as.character(stepsMedian))
print(meanPerDay)
```

```
##       [,1]         [,2]               
##  [1,] "2012-10-01" "NaN"              
##  [2,] "2012-10-02" "0.4375"           
##  [3,] "2012-10-03" "39.4166666666667" 
##  [4,] "2012-10-04" "42.0694444444444" 
##  [5,] "2012-10-05" "46.1597222222222" 
##  [6,] "2012-10-06" "53.5416666666667" 
##  [7,] "2012-10-07" "38.2465277777778" 
##  [8,] "2012-10-08" "NaN"              
##  [9,] "2012-10-09" "44.4826388888889" 
## [10,] "2012-10-10" "34.375"           
## [11,] "2012-10-11" "35.7777777777778" 
## [12,] "2012-10-12" "60.3541666666667" 
## [13,] "2012-10-13" "43.1458333333333" 
## [14,] "2012-10-14" "52.4236111111111" 
## [15,] "2012-10-15" "35.2048611111111" 
## [16,] "2012-10-16" "52.375"           
## [17,] "2012-10-17" "46.7083333333333" 
## [18,] "2012-10-18" "34.9166666666667" 
## [19,] "2012-10-19" "41.0729166666667" 
## [20,] "2012-10-20" "36.09375"         
## [21,] "2012-10-21" "30.6284722222222" 
## [22,] "2012-10-22" "46.7361111111111" 
## [23,] "2012-10-23" "30.9652777777778" 
## [24,] "2012-10-24" "29.0104166666667" 
## [25,] "2012-10-25" "8.65277777777778" 
## [26,] "2012-10-26" "23.5347222222222" 
## [27,] "2012-10-27" "35.1354166666667" 
## [28,] "2012-10-28" "39.7847222222222" 
## [29,] "2012-10-29" "17.4236111111111" 
## [30,] "2012-10-30" "34.09375"         
## [31,] "2012-10-31" "53.5208333333333" 
## [32,] "2012-11-01" "NaN"              
## [33,] "2012-11-02" "36.8055555555556" 
## [34,] "2012-11-03" "36.7048611111111" 
## [35,] "2012-11-04" "NaN"              
## [36,] "2012-11-05" "36.2465277777778" 
## [37,] "2012-11-06" "28.9375"          
## [38,] "2012-11-07" "44.7326388888889" 
## [39,] "2012-11-08" "11.1770833333333" 
## [40,] "2012-11-09" "NaN"              
## [41,] "2012-11-10" "NaN"              
## [42,] "2012-11-11" "43.7777777777778" 
## [43,] "2012-11-12" "37.3784722222222" 
## [44,] "2012-11-13" "25.4722222222222" 
## [45,] "2012-11-14" "NaN"              
## [46,] "2012-11-15" "0.142361111111111"
## [47,] "2012-11-16" "18.8923611111111" 
## [48,] "2012-11-17" "49.7881944444444" 
## [49,] "2012-11-18" "52.4652777777778" 
## [50,] "2012-11-19" "30.6979166666667" 
## [51,] "2012-11-20" "15.5277777777778" 
## [52,] "2012-11-21" "44.3993055555556" 
## [53,] "2012-11-22" "70.9270833333333" 
## [54,] "2012-11-23" "73.5902777777778" 
## [55,] "2012-11-24" "50.2708333333333" 
## [56,] "2012-11-25" "41.0902777777778" 
## [57,] "2012-11-26" "38.7569444444444" 
## [58,] "2012-11-27" "47.3819444444444" 
## [59,] "2012-11-28" "35.3576388888889" 
## [60,] "2012-11-29" "24.46875"         
## [61,] "2012-11-30" "NaN"
```

```r
print(medianPerDay)
```

```
##       [,1]         [,2]
##  [1,] "2012-10-01" NA  
##  [2,] "2012-10-02" "0" 
##  [3,] "2012-10-03" "0" 
##  [4,] "2012-10-04" "0" 
##  [5,] "2012-10-05" "0" 
##  [6,] "2012-10-06" "0" 
##  [7,] "2012-10-07" "0" 
##  [8,] "2012-10-08" NA  
##  [9,] "2012-10-09" "0" 
## [10,] "2012-10-10" "0" 
## [11,] "2012-10-11" "0" 
## [12,] "2012-10-12" "0" 
## [13,] "2012-10-13" "0" 
## [14,] "2012-10-14" "0" 
## [15,] "2012-10-15" "0" 
## [16,] "2012-10-16" "0" 
## [17,] "2012-10-17" "0" 
## [18,] "2012-10-18" "0" 
## [19,] "2012-10-19" "0" 
## [20,] "2012-10-20" "0" 
## [21,] "2012-10-21" "0" 
## [22,] "2012-10-22" "0" 
## [23,] "2012-10-23" "0" 
## [24,] "2012-10-24" "0" 
## [25,] "2012-10-25" "0" 
## [26,] "2012-10-26" "0" 
## [27,] "2012-10-27" "0" 
## [28,] "2012-10-28" "0" 
## [29,] "2012-10-29" "0" 
## [30,] "2012-10-30" "0" 
## [31,] "2012-10-31" "0" 
## [32,] "2012-11-01" NA  
## [33,] "2012-11-02" "0" 
## [34,] "2012-11-03" "0" 
## [35,] "2012-11-04" NA  
## [36,] "2012-11-05" "0" 
## [37,] "2012-11-06" "0" 
## [38,] "2012-11-07" "0" 
## [39,] "2012-11-08" "0" 
## [40,] "2012-11-09" NA  
## [41,] "2012-11-10" NA  
## [42,] "2012-11-11" "0" 
## [43,] "2012-11-12" "0" 
## [44,] "2012-11-13" "0" 
## [45,] "2012-11-14" NA  
## [46,] "2012-11-15" "0" 
## [47,] "2012-11-16" "0" 
## [48,] "2012-11-17" "0" 
## [49,] "2012-11-18" "0" 
## [50,] "2012-11-19" "0" 
## [51,] "2012-11-20" "0" 
## [52,] "2012-11-21" "0" 
## [53,] "2012-11-22" "0" 
## [54,] "2012-11-23" "0" 
## [55,] "2012-11-24" "0" 
## [56,] "2012-11-25" "0" 
## [57,] "2012-11-26" "0" 
## [58,] "2012-11-27" "0" 
## [59,] "2012-11-28" "0" 
## [60,] "2012-11-29" "0" 
## [61,] "2012-11-30" NA
```


Part2: What is the average daily activity pattern?

In this step, first the data will be subset to small chunks per each 5 minutes interval of all days collectively, then mean of each subset will be calculated. and plot of mean of nterval versus time interval will be made. 


```r
# time<-seq(from=0,to=2400,by=5)
start.date <- "2012-10-01"
start.time <- "00:00:00"
interval <- 5
increment.mins <- interval * 60
x <- paste(start.date, start.time)
time <- vector()

for (i in 1:288) {
    temp <- strftime(strptime(x, format = "%Y-%m-%d %H:%M:%S") + i * increment.mins, 
        "%H%M")
    time[i] <- temp
}


intervalMean <- vector("numeric", length = length(time))
for (i in seq_along(time)) {
    c <- subset(data, as.numeric(data$interval) == as.numeric(time[i]))
    intervalMean[i] <- mean(c$steps, na.rm = TRUE)
}
print(intervalMean)
```

```
##   [1]   0.33962   0.13208   0.15094   0.07547   2.09434   0.52830   0.86792
##   [8]   0.00000   1.47170   0.30189   0.13208   0.32075   0.67925   0.15094
##  [15]   0.33962   0.00000   1.11321   1.83019   0.16981   0.16981   0.37736
##  [22]   0.26415   0.00000   0.00000   0.00000   1.13208   0.00000   0.00000
##  [29]   0.13208   0.00000   0.22642   0.00000   0.00000   1.54717   0.94340
##  [36]   0.00000   0.00000   0.00000   0.00000   0.20755   0.62264   1.62264
##  [43]   0.58491   0.49057   0.07547   0.00000   0.00000   1.18868   0.94340
##  [50]   2.56604   0.00000   0.33962   0.35849   4.11321   0.66038   3.49057
##  [57]   0.83019   3.11321   1.11321   0.00000   1.56604   3.00000   2.24528
##  [64]   3.32075   2.96226   2.09434   6.05660  16.01887  18.33962  39.45283
##  [71]  44.49057  31.49057  49.26415  53.77358  63.45283  49.96226  47.07547
##  [78]  52.15094  39.33962  44.01887  44.16981  37.35849  49.03774  43.81132
##  [85]  44.37736  50.50943  54.50943  49.92453  50.98113  55.67925  44.32075
##  [92]  52.26415  69.54717  57.84906  56.15094  73.37736  68.20755 129.43396
##  [99] 157.52830 171.15094 155.39623 177.30189 206.16981 195.92453 179.56604
## [106] 183.39623 167.01887 143.45283 124.03774 109.11321 108.11321 103.71698
## [113]  95.96226  66.20755  45.22642  24.79245  38.75472  34.98113  21.05660
## [120]  40.56604  26.98113  42.41509  52.66038  38.92453  50.79245  44.28302
## [127]  37.41509  34.69811  28.33962  25.09434  31.94340  31.35849  29.67925
## [134]  21.32075  25.54717  28.37736  26.47170  33.43396  49.98113  42.03774
## [141]  44.60377  46.03774  59.18868  63.86792  87.69811  94.84906  92.77358
## [148]  63.39623  50.16981  54.47170  32.41509  26.52830  37.73585  45.05660
## [155]  67.28302  42.33962  39.88679  43.26415  40.98113  46.24528  56.43396
## [162]  42.75472  25.13208  39.96226  53.54717  47.32075  60.81132  55.75472
## [169]  51.96226  43.58491  48.69811  35.47170  37.54717  41.84906  27.50943
## [176]  17.11321  26.07547  43.62264  43.77358  30.01887  36.07547  35.49057
## [183]  38.84906  45.96226  47.75472  48.13208  65.32075  82.90566  98.66038
## [190] 102.11321  83.96226  62.13208  64.13208  74.54717  63.16981  56.90566
## [197]  59.77358  43.86792  38.56604  44.66038  45.45283  46.20755  43.67925
## [204]  46.62264  56.30189  50.71698  61.22642  72.71698  78.94340  68.94340
## [211]  59.66038  75.09434  56.50943  34.77358  37.45283  40.67925  58.01887
## [218]  74.69811  85.32075  59.26415  67.77358  77.69811  74.24528  85.33962
## [225]  99.45283  86.58491  85.60377  84.86792  77.83019  58.03774  53.35849
## [232]  36.32075  20.71698  27.39623  40.01887  30.20755  25.54717  45.66038
## [239]  33.52830  19.62264  19.01887  19.33962  33.33962  26.81132  21.16981
## [246]  27.30189  21.33962  19.54717  21.32075  32.30189  20.15094  15.94340
## [253]  17.22642  23.45283  19.24528  12.45283   8.01887  14.66038  16.30189
## [260]   8.67925   7.79245   8.13208   2.62264   1.45283   3.67925   4.81132
## [267]   8.50943   7.07547   8.69811   9.75472   2.20755   0.32075   0.11321
## [274]   1.60377   4.60377   3.30189   2.84906   0.00000   0.83019   0.96226
## [281]   1.58491   2.60377   4.69811   3.30189   0.64151   0.22642   1.07547
## [288]   1.71698
```

```r

plot(strptime(time, format = "%H%M"), intervalMean, type = "l", xlab = "time", 
    ylab = "Mean of Steps")
```

![plot of chunk average_daily_activity](figure/average_daily_activity.png) 


According to this plot, 08:35 interval has the maximum average of steps over all days.


Part3: Imputing missing values

number of rows with a missing value (i.e. NAs) is 2304

In this part, first rows of data with a missing value are detected, then they are replaced by mean of that interval over all other days and produce a new data set.

Then the new data will be subsetized for each day separately and mean and median of data over each day will be calculated.



```r
index <- which(is.na(data$steps))
new_data <- data
for (i in index) {
    new_data$steps[i] <- intervalMean[which(as.numeric(time) == new_data$interval[i])]
}

stepsMeanNew <- vector("numeric", length = length(days))
stepsMedianNew <- vector("numeric", length = length(days))
totalStepsNew <- vector("numeric", length = length(days))

for (i in seq_along(days)) {
    b <- subset(new_data, as.Date(new_data$date, format = "%Y-%m-%d") == days[i])
    stepsMeanNew[i] <- mean(as.numeric(b$steps), na.rm = TRUE)
    stepsMedianNew[i] <- median(as.numeric(b$steps), na.rm = TRUE)
    totalStepsNew[i] <- sum(as.numeric(b$steps), na.rm = TRUE)
}

plot(days, totalStepsNew)
lines(days, totalStepsNew)
```

![plot of chunk Imputing_missing_values](figure/Imputing_missing_values.png) 

```r
meanPerDayNew <- cbind(as.character(days), as.character(stepsMeanNew))
medianPerDayNew <- cbind(as.character(days), as.character(stepsMedianNew))
print(meanPerDayNew)
```

```
##       [,1]         [,2]               
##  [1,] "2012-10-01" "37.3825995807128" 
##  [2,] "2012-10-02" "0.4375"           
##  [3,] "2012-10-03" "39.4166666666667" 
##  [4,] "2012-10-04" "42.0694444444444" 
##  [5,] "2012-10-05" "46.1597222222222" 
##  [6,] "2012-10-06" "53.5416666666667" 
##  [7,] "2012-10-07" "38.2465277777778" 
##  [8,] "2012-10-08" "37.3825995807128" 
##  [9,] "2012-10-09" "44.4826388888889" 
## [10,] "2012-10-10" "34.375"           
## [11,] "2012-10-11" "35.7777777777778" 
## [12,] "2012-10-12" "60.3541666666667" 
## [13,] "2012-10-13" "43.1458333333333" 
## [14,] "2012-10-14" "52.4236111111111" 
## [15,] "2012-10-15" "35.2048611111111" 
## [16,] "2012-10-16" "52.375"           
## [17,] "2012-10-17" "46.7083333333333" 
## [18,] "2012-10-18" "34.9166666666667" 
## [19,] "2012-10-19" "41.0729166666667" 
## [20,] "2012-10-20" "36.09375"         
## [21,] "2012-10-21" "30.6284722222222" 
## [22,] "2012-10-22" "46.7361111111111" 
## [23,] "2012-10-23" "30.9652777777778" 
## [24,] "2012-10-24" "29.0104166666667" 
## [25,] "2012-10-25" "8.65277777777778" 
## [26,] "2012-10-26" "23.5347222222222" 
## [27,] "2012-10-27" "35.1354166666667" 
## [28,] "2012-10-28" "39.7847222222222" 
## [29,] "2012-10-29" "17.4236111111111" 
## [30,] "2012-10-30" "34.09375"         
## [31,] "2012-10-31" "53.5208333333333" 
## [32,] "2012-11-01" "37.3825995807128" 
## [33,] "2012-11-02" "36.8055555555556" 
## [34,] "2012-11-03" "36.7048611111111" 
## [35,] "2012-11-04" "37.3825995807128" 
## [36,] "2012-11-05" "36.2465277777778" 
## [37,] "2012-11-06" "28.9375"          
## [38,] "2012-11-07" "44.7326388888889" 
## [39,] "2012-11-08" "11.1770833333333" 
## [40,] "2012-11-09" "37.3825995807128" 
## [41,] "2012-11-10" "37.3825995807128" 
## [42,] "2012-11-11" "43.7777777777778" 
## [43,] "2012-11-12" "37.3784722222222" 
## [44,] "2012-11-13" "25.4722222222222" 
## [45,] "2012-11-14" "37.3825995807128" 
## [46,] "2012-11-15" "0.142361111111111"
## [47,] "2012-11-16" "18.8923611111111" 
## [48,] "2012-11-17" "49.7881944444444" 
## [49,] "2012-11-18" "52.4652777777778" 
## [50,] "2012-11-19" "30.6979166666667" 
## [51,] "2012-11-20" "15.5277777777778" 
## [52,] "2012-11-21" "44.3993055555556" 
## [53,] "2012-11-22" "70.9270833333333" 
## [54,] "2012-11-23" "73.5902777777778" 
## [55,] "2012-11-24" "50.2708333333333" 
## [56,] "2012-11-25" "41.0902777777778" 
## [57,] "2012-11-26" "38.7569444444444" 
## [58,] "2012-11-27" "47.3819444444444" 
## [59,] "2012-11-28" "35.3576388888889" 
## [60,] "2012-11-29" "24.46875"         
## [61,] "2012-11-30" "37.3825995807128"
```

```r
print(medianPerDayNew)
```

```
##       [,1]         [,2]              
##  [1,] "2012-10-01" "34.1132075471698"
##  [2,] "2012-10-02" "0"               
##  [3,] "2012-10-03" "0"               
##  [4,] "2012-10-04" "0"               
##  [5,] "2012-10-05" "0"               
##  [6,] "2012-10-06" "0"               
##  [7,] "2012-10-07" "0"               
##  [8,] "2012-10-08" "34.1132075471698"
##  [9,] "2012-10-09" "0"               
## [10,] "2012-10-10" "0"               
## [11,] "2012-10-11" "0"               
## [12,] "2012-10-12" "0"               
## [13,] "2012-10-13" "0"               
## [14,] "2012-10-14" "0"               
## [15,] "2012-10-15" "0"               
## [16,] "2012-10-16" "0"               
## [17,] "2012-10-17" "0"               
## [18,] "2012-10-18" "0"               
## [19,] "2012-10-19" "0"               
## [20,] "2012-10-20" "0"               
## [21,] "2012-10-21" "0"               
## [22,] "2012-10-22" "0"               
## [23,] "2012-10-23" "0"               
## [24,] "2012-10-24" "0"               
## [25,] "2012-10-25" "0"               
## [26,] "2012-10-26" "0"               
## [27,] "2012-10-27" "0"               
## [28,] "2012-10-28" "0"               
## [29,] "2012-10-29" "0"               
## [30,] "2012-10-30" "0"               
## [31,] "2012-10-31" "0"               
## [32,] "2012-11-01" "34.1132075471698"
## [33,] "2012-11-02" "0"               
## [34,] "2012-11-03" "0"               
## [35,] "2012-11-04" "34.1132075471698"
## [36,] "2012-11-05" "0"               
## [37,] "2012-11-06" "0"               
## [38,] "2012-11-07" "0"               
## [39,] "2012-11-08" "0"               
## [40,] "2012-11-09" "34.1132075471698"
## [41,] "2012-11-10" "34.1132075471698"
## [42,] "2012-11-11" "0"               
## [43,] "2012-11-12" "0"               
## [44,] "2012-11-13" "0"               
## [45,] "2012-11-14" "34.1132075471698"
## [46,] "2012-11-15" "0"               
## [47,] "2012-11-16" "0"               
## [48,] "2012-11-17" "0"               
## [49,] "2012-11-18" "0"               
## [50,] "2012-11-19" "0"               
## [51,] "2012-11-20" "0"               
## [52,] "2012-11-21" "0"               
## [53,] "2012-11-22" "0"               
## [54,] "2012-11-23" "0"               
## [55,] "2012-11-24" "0"               
## [56,] "2012-11-25" "0"               
## [57,] "2012-11-26" "0"               
## [58,] "2012-11-27" "0"               
## [59,] "2012-11-28" "0"               
## [60,] "2012-11-29" "0"               
## [61,] "2012-11-30" "34.1132075471698"
```



In this step, days of data will be labled as weekdays or weekends, then data will be subsetized to two groups of weekdays and weekends. The each of these groups will be subsetized separately to groups with the same five minute time interval, average of steps over each interval will be calculated and then will be plotted.


```r
new_data$weekDays <- weekdays(strptime(new_data$date, format = "%Y-%m-%d"))
weekday_level <- c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")
weekends_level <- c("Saturday", "Sunday")
new_data$weekdays_lable <- factor(new_data$weekDays, levels = c(weekday_level, 
    weekends_level), labels = c("Weekday", "Weekday", "Weekday", "Weekday", 
    "Weekday", "Weekend", "Weekend"))
```

```
## Warning: duplicated levels in factors are deprecated
```

```r

new_data_weekdays <- subset(new_data, new_data$weekdays_lable == "Weekday")
new_data_weekend <- subset(new_data, new_data$weekdays_lable == "Weekend")

intervalMeanWeekdays <- vector("numeric", length = length(time))
for (i in seq_along(time)) {
    c <- subset(new_data_weekdays, as.numeric(new_data_weekdays$interval) == 
        as.numeric(time[i]))
    intervalMeanWeekdays[i] <- mean(c$steps, na.rm = TRUE)
}


intervalMeanWeekends <- vector("numeric", length = length(time))
for (i in seq_along(time)) {
    c <- subset(new_data_weekend, as.numeric(new_data_weekend$interval) == as.numeric(time[i]))
    intervalMeanWeekends[i] <- mean(c$steps, na.rm = TRUE)
}

par(mfrow = c(2, 1))
plot(strptime(time, format = "%H%M"), intervalMeanWeekends, type = "l", xlab = "time", 
    ylab = "Mean of Steps", main = "Weekend")
plot(strptime(time, format = "%H%M"), intervalMeanWeekdays, type = "l", xlab = "time", 
    ylab = "Mean of Steps", main = "Weekdays")
```

![plot of chunk unnamed-chunk-1](figure/unnamed-chunk-1.png) 

